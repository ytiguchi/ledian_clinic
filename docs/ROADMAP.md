# ロードマップ

最終更新: 2024-12-26

このドキュメントは **運用・意思決定のための最短ルート**です。  
詳細な技術計画や過去の議論は `docs/INDEX.md` から辿れます。

---

## 現在のステータス

### ✅ Internal Site (管理サイト) - 75%完了

| 機能 | 進捗 | 備考 |
|------|------|------|
| 基盤構築 | ✅ 100% | Astro + D1 + Cloudflare Pages |
| 料金管理 | ✅ 100% | 一覧/新規/編集/インライン編集 |
| キャンペーン管理 | ✅ 90% | 一覧/作成/編集 |
| 施術管理 | ✅ 90% | 詳細ページ/編集/料金連携 |
| 症例写真管理 | ✅ 90% | 一覧/編集/R2移行スクリプト |
| 新商品導入管理 | ✅ 80% | プロジェクト/タスク管理 |
| 画像/R2管理 | 🔄 40% | 移行完了、アップロードUI未 |
| データエクスポート | ⏳ 0% | - |
| 認証・認可 | ⏳ 0% | - |

**本番URL:** https://ledian-clinic-internal.pages.dev/

---

## 次の大型プロジェクト: 公開サイト再構築 🚀

**internal-site を CMS として活用し、ledianclinic.jp を Cloudflare Pages + D1 で再構築する計画**

| 項目 | 内容 |
|------|------|
| 目標 | https://ledianclinic.jp/ を internal-site と同じ D1 データベースで運用 |
| 工数 | 4-6週間（フルタイム1人） |
| 技術 | Astro + Cloudflare Pages + D1（internal-siteと統一） |
| メリット | コンテンツ一元管理、リアルタイム更新、運用コスト削減 |

**詳細:** [公開サイト構築計画](./PUBLIC_SITE_PLAN.md)

---

## P0タスク（公開サイト準備）

### データ棚卸し
- [ ] 公開サイトのページ一覧を確定
- [ ] 各ページの必須データ項目を列挙（D1対応表作成）
- [ ] 既存D1の対応状況を確認（不足項目・NULL許容整理）

### 公開フラグ統一
- [ ] 公開フラグ名称決定（`is_published`）と対象テーブル洗い出し
- [ ] 公開/非公開の運用ルール定義
- [ ] 公開サイト側のフィルタ条件定義

### スキーマ統合
- [ ] 統合スキーマの正本決定
- [ ] 主キー型の統一（INTEGER vs TEXT）
- [ ] 参照キーの統一
- [ ] 症例テーブル名統一

---

## P1タスク

### API整備
- [ ] 公開サイト用の読み取りAPI方針決定
- [ ] APIレスポンス/エラー形式の統一
- [ ] 公開向けフィルタ共通化

### 画像/アセット
- [x] R2の公開URL設計 → `https://pub-7fb3b78717844555a19c9c9ccae5f2f9.r2.dev`
- [x] 既存画像のR2移行スクリプト作成
- [ ] 画像最適化ルールの決定

### キャッシュ/パフォーマンス
- [ ] キャッシュ戦略の方針決定（SSG/ISR/KV/Cache API）
- [ ] 公開サイト向け `Cache-Control` ルール整理

### ルーティング/URL設計
- [ ] URL/slug命名規則の統一
- [ ] 旧サイトからのURL互換/リダイレクト方針

---

## いつか（Someday）

- 外部システム連携（POS / カルテ）
- データ分析・レポート
- 認証・認可の強化（ロール/操作ログ）
- メディア（画像/動画）管理の統一・CMS移行

---

## 参考リンク（詳細）

- 進捗状況: `docs/internal-site-progress.md`
- 作業メモ/タスク候補: `docs/tasks.md`
- 全体の古い/詳細ロードマップ: `docs/COMPREHENSIVE_ROADMAP.md`
